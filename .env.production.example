# ============================================
# CONFIGURACIÓN DE PRODUCCIÓN - SUPABASE
# ============================================
# Copiar a .env.production y completar con valores reales

# ============================================
# SUPABASE - BASE DE DATOS
# ============================================
# Obtener de: Supabase Dashboard → Settings → Database → Connection string
# IMPORTANTE: Usar puerto 6543 para connection pooling (PgBouncer)
DATABASE_URL=postgresql://postgres:[YOUR-PASSWORD]@db.[YOUR-PROJECT-REF].supabase.co:6543/postgres?pgbouncer=true

# URL directa para migraciones (puerto 5432)
DIRECT_URL=postgresql://postgres:[YOUR-PASSWORD]@db.[YOUR-PROJECT-REF].supabase.co:5432/postgres

# URL de réplica (opcional, solo en planes pagos de Supabase)
DATABASE_READ_REPLICA_URL=

# ============================================
# SUPABASE - API KEYS
# ============================================
# Obtener de: Supabase Dashboard → Settings → API
SUPABASE_URL=https://[YOUR-PROJECT-REF].supabase.co
SUPABASE_ANON_KEY=[YOUR-ANON-KEY]
SUPABASE_SERVICE_ROLE_KEY=[YOUR-SERVICE-ROLE-KEY]

# ============================================
# REDIS - CACHE (Opcional)
# ============================================
# Opciones:
# 1. Upstash: https://upstash.com (Gratis, serverless)
# 2. Redis Cloud: https://redis.com/cloud (30MB gratis)
# 3. Railway Redis: https://railway.app

# Ejemplo Upstash:
REDIS_URL=rediss://default:[PASSWORD]@[ENDPOINT].upstash.io:[PORT]

# Ejemplo Redis Cloud:
# REDIS_URL=redis://default:[PASSWORD]@[ENDPOINT]:[PORT]

REDIS_ENABLED=True
REDIS_CACHE_TTL=300

# ============================================
# JWT - AUTENTICACIÓN
# ============================================
# Generar con: python -c "import secrets; print(secrets.token_urlsafe(64))"
JWT_SECRET_KEY=[GENERAR-UNO-NUEVO-MUY-SEGURO]
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# ============================================
# CORS - ORÍGENES PERMITIDOS
# ============================================
# Separar múltiples orígenes con comas
# Ejemplo: https://app.vercel.app,https://tudominio.com
CORS_ORIGINS=https://[TU-APP].vercel.app,https://[TU-DOMINIO].com

# ============================================
# CONFIGURACIÓN DE ENTORNO
# ============================================
APP_ENV=production
DEBUG=False
FORCE_HTTPS=True

# ============================================
# POOL DE CONEXIONES (Optimizado para Supabase Free Tier)
# ============================================
# Free tier de Supabase permite hasta 50 conexiones
# Recomendado: 10-15 por instancia
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=5
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=300  # 5 minutos (Supabase cierra conexiones idle)
DB_POOL_PRE_PING=True
DB_ECHO=False

# ============================================
# API GATEWAY - Microservicios (Opcional)
# ============================================
# Generar con: python -c "import secrets; print(secrets.token_urlsafe(32))"
INTERNAL_API_KEYS=[TU-API-KEY-1],[TU-API-KEY-2]
API_KEY_HEADER_NAME=X-API-Key

# URLs de microservicios externos (si aplica)
HIS_API_URL=
LABORATORIO_API_URL=
IMAGENOLOGIA_API_URL=
FARMACIA_API_URL=

EXTERNAL_API_TIMEOUT=10
EXTERNAL_API_RETRIES=3

# ============================================
# SEGURIDAD
# ============================================
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=True
PASSWORD_REQUIRE_LOWERCASE=True
PASSWORD_REQUIRE_DIGIT=True
PASSWORD_REQUIRE_SPECIAL=False

MAX_LOGIN_ATTEMPTS=5
LOGIN_LOCKOUT_MINUTES=15

# Rate Limiting
RATE_LIMIT_ENABLED=True
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_LOGIN_PER_MINUTE=5
RATE_LIMIT_API_PUBLIC_PER_MINUTE=20

# ============================================
# LOGGING
# ============================================
LOG_LEVEL=INFO
LOG_FORMAT="%(asctime)s | %(levelname)-8s | %(name)s | %(message)s"

# ============================================
# UPLOADS
# ============================================
UPLOAD_DIR=uploads
MAX_UPLOAD_SIZE=10485760  # 10MB
ALLOWED_EXTENSIONS=.pdf

# ============================================
# PROCESOS AUTOMÁTICOS
# ============================================
PROCESO_AUTOMATICO_INTERVALO=5
TIEMPO_LIMPIEZA_DEFAULT=60
TIEMPO_ESPERA_OXIGENO_DEFAULT=120

# ============================================
# WEBSOCKET
# ============================================
WS_RECONNECT_INTERVAL=3
WS_MAX_RECONNECT_ATTEMPTS=10

# ============================================
# MULTI-TENANCY
# ============================================
ENABLE_MULTI_TENANCY=True
DEFAULT_TENANT_ID=
TENANT_HEADER_NAME=X-Hospital-ID
